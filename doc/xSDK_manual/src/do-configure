#!/bin/bash
#

TRILINOS_HOME=/path/to/Trilinos

PETSC_INCLUDE_DIR=/path/to/petsc/include
PETSC_LIB_DIR=/path/to/petsc/lib

HYPRE_INCLUDE_DIR=/path/to/hypre/include
HYPRE_LIB_DIR=/path/to/hypre/lib

METIS_INCLUDE_DIR=/path/to/metis/include
METIS_LIB_DIR=/path/to/metis/lib

PARMETIS_INCLUDE_DIR=/path/to/parmetis/include
PARMETIS_LIB_DIR=/path/to/parmetis/lib

SUPERLU_INCLUDE_DIR=/path/to/superlu/include
SUPERLU_LIB_DIR=/path/to/superlu/lib

rm -rf CMakeFiles CMakeCache.txt

cmake \
  -D CMAKE_BUILD_TYPE=DEBUG \
  -D CMAKE_INSTALL_PREFIX:PATH="~/trilinos-install" \
  -D TPL_ENABLE_MPI:BOOL=ON \
  -D Trilinos_ENABLE_EXPLICIT_INSTANTIATION:BOOL=ON \
  -D Teuchos_ENABLE_COMPLEX:BOOL=OFF \
  -D Trilinos_ENABLE_TESTS:BOOL=ON \
  -D Trilinos_ENABLE_EXAMPLES:BOOL=ON \
  -D Trilinos_ENABLE_ALL_OPTIONAL_PACKAGES=ON \
\
  -D BLAS_LIBRARY_NAMES:STRING="libf77blas.so.3" \
  -D BLAS_LIBRARY_DIRS:PATH="/usr/lib64/atlas" \
  -D LAPACK_LIBRARY_NAMES:STRING="liblapack.so.3" \
  -D LAPACK_LIBRARY_DIRS:PATH="/usr/lib64/atlas" \
\
  -D TPL_ENABLE_PETSC:BOOL=ON \
  -D PETSC_LIBRARY_DIRS:FILEPATH="${PETSC_LIB_DIR}" \
  -D PETSC_INCLUDE_DIRS:FILEPATH="${PETSC_INCLUDE_DIR}" \
\
  -D TPL_ENABLE_HYPRE:BOOL=ON \
  -D HYPRE_LIBRARY_DIRS:FILEPATH="${HYPRE_LIB_DIR}" \
  -D HYPRE_INCLUDE_DIRS:FILEPATH="${HYPRE_INCLUDE_DIR}" \
\
  -D TPL_ENABLE_ParMETIS:BOOL=ON \
  -D ParMETIS_LIBRARY_DIRS:FILEPATH="${PARMETIS_LIB_DIR};${METIS_LIB_DIR}" \
  -D TPL_ParMETIS_INCLUDE_DIRS:FILEPATH="${PARMETIS_INCLUDE_DIR};${METIS_INCLUDE_DIR}" \
\
  -D TPL_ENABLE_SuperLUDist:BOOL=ON \
  -D SuperLUDist_LIBRARY_DIRS:FILEPATH="${SUPERLU_LIB_DIR}" \
  -D SuperLUDist_INCLUDE_DIRS:FILEPATH="${SUPERLU_INCLUDE_DIR}" \
\
  -D Trilinos_ENABLE_Amesos2:BOOL=ON \
  -D Trilinos_ENABLE_xSDKTrilinos:BOOL=ON \
\
  ${TRILINOS_HOME}